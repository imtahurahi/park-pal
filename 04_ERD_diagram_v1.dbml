// National Park Travel Planner - Database Schema
// ERD Diagram v1.0

// ===================================
// USER MANAGEMENT
// ===================================

Table Users {
  user_id int [pk, increment]
  email varchar(255) [unique, not null]
  password_hash varchar(255) [not null]
  name varchar(100)
  profile_picture varchar(500)
  budget_range_preference varchar(50)
  activity_level_preference varchar(50)
  accommodation_type_preference varchar(50)
  created_at timestamp [default: `now()`]
  last_login timestamp
  email_verified boolean [default: false]
}

// ===================================
// NATIONAL PARKS
// ===================================

Table Parks {
  park_id int [pk, increment]
  park_name varchar(200) [not null]
  state varchar(50) [not null]
  latitude decimal(10,8)
  longitude decimal(11,8)
  description text
  highlights text
  difficulty_level varchar(50)
  family_friendly boolean [default: false]
  entrance_fee decimal(10,2)
  best_seasons varchar(100)
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

Table Activities {
  activity_id int [pk, increment]
  activity_name varchar(100) [not null]
  description text
}

Table Park_Activities {
  park_id int [not null]
  activity_id int [not null]
  
  indexes {
    (park_id, activity_id) [pk]
  }
}

Table Amenities {
  amenity_id int [pk, increment]
  amenity_name varchar(100) [not null]
  description text
}

Table Park_Amenities {
  park_id int [not null]
  amenity_id int [not null]
  
  indexes {
    (park_id, amenity_id) [pk]
  }
}

// ===================================
// FLIGHTS & AIRPORTS
// ===================================

Table Airports {
  airport_id int [pk, increment]
  airport_code varchar(10) [unique, not null]
  airport_name varchar(200) [not null]
  city varchar(100)
  state varchar(50)
  latitude decimal(10,8)
  longitude decimal(11,8)
}

Table Park_Airports {
  park_id int [not null]
  airport_id int [not null]
  distance_miles decimal(10,2)
  
  indexes {
    (park_id, airport_id) [pk]
  }
}

Table Airlines {
  airline_id int [pk, increment]
  airline_name varchar(100) [not null]
  airline_code varchar(10) [unique]
}

Table Flights {
  flight_id int [pk, increment]
  airline_id int [not null]
  flight_number varchar(20) [not null]
  origin_airport_id int [not null]
  destination_airport_id int [not null]
  departure_time time
  arrival_time time
  duration_minutes int
  price decimal(10,2)
  punctuality_score decimal(5,2)
  average_delay_minutes int
  number_of_stops int [default: 0]
  flight_date date [not null]
  created_at timestamp [default: `now()`]
}

// ===================================
// LODGING
// ===================================

Table Lodging {
  lodging_id int [pk, increment]
  park_id int [not null]
  name varchar(200) [not null]
  type varchar(50)
  address varchar(500)
  latitude decimal(10,8)
  longitude decimal(11,8)
  distance_from_park_miles decimal(10,2)
  price_range varchar(10)
  contact_phone varchar(20)
  contact_email varchar(100)
  website varchar(500)
  wifi_available boolean [default: false]
  pet_friendly boolean [default: false]
  accessibility_features boolean [default: false]
}

// ===================================
// TRIP PLANNING
// ===================================

Table Trips {
  trip_id int [pk, increment]
  user_id int [not null]
  park_id int [not null]
  flight_id int
  lodging_id int
  title varchar(200) [not null]
  description text
  arrival_date date [not null]
  departure_date date [not null]
  status varchar(20) [default: 'draft']
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  is_deleted boolean [default: false]
}

Table Notes {
  note_id int [pk, increment]
  user_id int [not null]
  trip_id int
  title varchar(200)
  content text
  category varchar(50)
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

Table Wishlists {
  wishlist_id int [pk, increment]
  user_id int [not null]
  park_id int [not null]
  priority varchar(20)
  visited boolean [default: false]
  added_at timestamp [default: `now()`]
  visited_date date
  
  indexes {
    (user_id, park_id) [unique]
  }
}

// ===================================
// RELATIONSHIPS
// ===================================

// Users to Trips (1:M)
Ref: Users.user_id < Trips.user_id [delete: cascade]

// Parks to Trips (1:M)
Ref: Parks.park_id < Trips.park_id [delete: restrict]

// Flights to Trips (1:M - optional)
Ref: Flights.flight_id < Trips.flight_id [delete: set null]

// Lodging to Trips (1:M - optional)
Ref: Lodging.lodging_id < Trips.lodging_id [delete: set null]

// Users to Notes (1:M)
Ref: Users.user_id < Notes.user_id [delete: cascade]

// Trips to Notes (1:M - optional)
Ref: Trips.trip_id < Notes.trip_id [delete: set null]

// Parks to Activities (M:N)
Ref: Parks.park_id < Park_Activities.park_id [delete: cascade]
Ref: Activities.activity_id < Park_Activities.activity_id [delete: cascade]

// Parks to Amenities (M:N)
Ref: Parks.park_id < Park_Amenities.park_id [delete: cascade]
Ref: Amenities.amenity_id < Park_Amenities.amenity_id [delete: cascade]

// Parks to Airports (M:N)
Ref: Parks.park_id < Park_Airports.park_id [delete: cascade]
Ref: Airports.airport_id < Park_Airports.airport_id [delete: cascade]

// Airlines to Flights (1:M)
Ref: Airlines.airline_id < Flights.airline_id [delete: restrict]

// Airports to Flights - Origin (1:M)
Ref: Airports.airport_id < Flights.origin_airport_id [delete: restrict]

// Airports to Flights - Destination (1:M)
Ref: Airports.airport_id < Flights.destination_airport_id [delete: restrict]

// Parks to Lodging (1:M)
Ref: Parks.park_id < Lodging.park_id [delete: cascade]

// Users to Wishlists (1:M)
Ref: Users.user_id < Wishlists.user_id [delete: cascade]

// Parks to Wishlists (1:M)
Ref: Parks.park_id < Wishlists.park_id [delete: cascade]
